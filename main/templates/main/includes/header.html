{% load static %}
<style>
    .mxd-logo_txt {
        font-weight: bold;
        color: #f66e2e;
        font-size: 4rem;
        text-transform: uppercase;
    }
</style>
<nav id="header" class="mxd-nav__wrap" data-lenis-prevent="">
    <!-- Логотип -->
    <div class="mxd-header__logo loading__fade">
        <a href="{% url 'home' %}" class="mxd-logo">
            <img src="{% static 'images/logo/autoliga-logo.png' %}" style="width: 70px;" class="mxd-logo__image" alt="Autoliga Logo">
            <span class="mxd-logo_txt">Autoliga</span>
        </a>
    </div>

    <!-- Десктопное меню -->
    <div class="mxd-header__nav loading__fade">
        <ul class="desktop-menu">
            <li class="desktop-menu__item active">
                <a href="{% url 'home' %}" class="desktop-menu__link">
                    {% if LANGUAGE_CODE == 'ru' %}Главная{% elif LANGUAGE_CODE == 'en' %}Home{% else %}Bosh sahifa{% endif %}
                </a>
            </li>
            <li class="desktop-menu__item">
                <a href="javascript:void(0)" class="desktop-menu__link">
                    {% if LANGUAGE_CODE == 'ru' %}Бренды{% elif LANGUAGE_CODE == 'en' %}Brands{% else %}Brendlar{% endif %}
                    <span class="desktop-menu__arrow">▼</span>
                </a>
                <!-- ✅ Меню будет заполнено динамически через JS -->
                <ul class="desktop-submenu">
                    <li class="desktop-submenu__item">
                        <span style="color: #999;">
                            {% if LANGUAGE_CODE == 'ru' %}Загрузка...{% elif LANGUAGE_CODE == 'en' %}Loading...{% else %}Yuklanmoqda...{% endif %}
                        </span>
                    </li>
                </ul>
            </li>
            <li class="desktop-menu__item">
                <a href="{% url 'news' %}" class="desktop-menu__link">
                    {% if LANGUAGE_CODE == 'ru' %}Новости{% elif LANGUAGE_CODE == 'en' %}News{% else %}Yangiliklar{% endif %}
                </a>
            </li>
            <li class="desktop-menu__item">
                <a href="{% url 'contact' %}" class="desktop-menu__link">
                    {% if LANGUAGE_CODE == 'ru' %}Контакты{% elif LANGUAGE_CODE == 'en' %}Contacts{% else %}Bog'lanish{% endif %}
                </a>
            </li>
        </ul>
    </div>

    <!-- Элементы управления -->
    <div class="mxd-header__controls loading__fade">
        <!-- Переключатель языка -->
        <form action="{% url 'set_language' %}" method="post" class="language-switcher-form"
            style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="language" value="" id="language-input">
            <div class="language-switcher">
                <span class="language-current">
                    {% if LANGUAGE_CODE == 'ru' %}RU{% elif LANGUAGE_CODE == 'en' %}EN{% else %}UZ{% endif %}
                </span>
                <span class="language-arrow">▼</span>
                <div class="language-dropdown">
                    <a href="#" class="language-option {% if LANGUAGE_CODE == 'uz' %}active{% endif %}"
                        data-lang="uz" onclick="switchLanguage('uz'); return false;">O'zbek</a>
                    <a href="#" class="language-option {% if LANGUAGE_CODE == 'ru' %}active{% endif %}"
                        data-lang="ru" onclick="switchLanguage('ru'); return false;">Русский</a>
                    <a href="#" class="language-option {% if LANGUAGE_CODE == 'en' %}active{% endif %}"
                        data-lang="en" onclick="switchLanguage('en'); return false;">English</a>
                </div>
            </div>
        </form>

        <button id="color-switcher" class="mxd-color-switcher" type="button" role="switch"
            aria-label="light/dark mode" aria-checked="true"></button>

        {% if request.resolver_match.url_name == 'home' %}
        <a class="btn btn-anim btn-default btn-mobile-icon btn-outline slide-right-up" style="gap: 0;"
            href="#faw-main-contact-form" target="_blank" aria-label="Перейти к форме связи">
            <i class="ph-bold ph-arrow-up-right"></i>
        </a>
        {% endif %}
    </div>

    <!-- Гамбургер -->
    <div class="mxd-nav__contain loading__fade">
        <a href="#0" class="mxd-nav__hamburger">
            <div class="hamburger__base"></div>
            <div class="hamburger__line"></div>
            <div class="hamburger__line"></div>
        </a>
    </div>

    <!-- Мобильное меню -->
    <div class="mxd-menu__wrapper">
        <div class="mxd-menu__base"></div>
        <div class="mxd-menu__contain">
            <div class="mxd-menu__inner">
                <div class="mxd-menu__left">
                    <p class="mxd-menu__caption menu-fade-in">
                        Autoliga Uzbekistan<br>
                        {% if LANGUAGE_CODE == 'ru' %}Надежные транспортные решения{% elif LANGUAGE_CODE == 'en' %}Reliable transport solutions{% else %}Ishonchli transport yechimlari{% endif %}
                    </p>
                    <div class="main-menu">
                        <nav class="main-menu__content">
                            <ul id="main-menu" class="main-menu__accordion">
                                <li class="main-menu__item">
                                    <a class="main-menu__link btn" href="{% url 'home' %}">
                                        <span class="btn-caption">
                                            {% if LANGUAGE_CODE == 'ru' %}Главная{% elif LANGUAGE_CODE == 'en' %}Home{% else %}Bosh sahifa{% endif %}
                                        </span>
                                    </a>
                                </li>
                                <li class="main-menu__item">
                                    <div class="main-menu__toggle">
                                        <span class="main-menu__link">
                                            {% if LANGUAGE_CODE == 'ru' %}Модели{% elif LANGUAGE_CODE == 'en' %}Models{% else %}Modellar{% endif %}
                                            <span class="main-menu__arrow" style="font-size: 15px;">▼</span>
                                        </span>
                                    </div>
                                    <!-- ✅ Меню будет заполнено динамически через JS -->
                                    <ul class="submenu">
                                        <li class="submenu__item">
                                            <span style="color: #999;">
                                                {% if LANGUAGE_CODE == 'ru' %}Загрузка...{% elif LANGUAGE_CODE == 'en' %}Loading...{% else %}Yuklanmoqda...{% endif %}
                                            </span>
                                        </li>
                                    </ul>
                                </li>
                                <li class="main-menu__item">
                                    <a class="main-menu__link btn" href="{% url 'contact' %}">
                                        <span class="btn-caption">
                                            {% if LANGUAGE_CODE == 'ru' %}Контакты{% elif LANGUAGE_CODE == 'en' %}Contacts{% else %}Bog'lanish{% endif %}
                                        </span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
                <div class="mxd-menu__data menu-fade-in">
                    <p class="t-xsmall">
                        Autoliga Uzbekistan
                    </p>
                    <p class="t-xsmall">
                        <i class="ph ph-copyright"></i>
                        2025
                    </p>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- ✅ ДОБАВЛЯЕМ СКРИПТ ДИНАМИЧЕСКОГО МЕНЮ -->
<script src="{% static 'js/dynamic-menu.js' %}"></script>
<script src="{% static 'js/error-logger.js' %}"></script>
<script>
function switchLanguage(lang) {
    console.log('Switching to language:', lang);
    document.getElementById('language-input').value = lang;
    sessionStorage.setItem('languageChanged', 'true');
    document.querySelector('.language-switcher-form').submit();
}
</script>